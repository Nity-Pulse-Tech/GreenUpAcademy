{% extends 'publics/home/base.html' %}
{% load static %}
{% load i18n %}

{% block extra_head %}
    <script src="{% static 'js/common/toast_manager.js' %}"></script>
    <script src="{% static 'js/common/notification_manager.js' %}"></script>
{% endblock %}

{% block content %}
<style>
    .admission-step {
        transition: all 0.3s ease;
    }
    .admission-step:hover {
        transform: translateY(-5px);
    }
    .form-section {
        transition: all 0.3s ease;
    }
    .form-section:hover {
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    }
    .program-table {
        border-collapse: separate;
        border-spacing: 0;
    }
    .program-table th, .program-table td {
        border: 1px solid #e5e7eb;
    }
    .program-table tr:hover {
        background-color: #f9fafb;
    }
</style>

<!-- Breadcrumb Section -->
<section class="bg-primary-green text-white py-6">
    <div class="container mx-auto px-4">
        <div class="text-center">
            <h1 class="text-3xl font-bold mb-2">{% trans "Procédure d'Admission" %}</h1>
            <p class="text-lg">Green Up Academy > Admission</p>
        </div>
    </div>
</section>

<!-- Main Content Section -->
<main class="py-12">
    <div class="container mx-auto px-4">
        <!-- Admission Process Steps -->
        <section class="mb-16">
            <h2 class="text-3xl font-bold text-center mb-12">{% trans "Processus d'Admission" %}</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <!-- Step 1 -->
                <div class="bg-white rounded-lg shadow-lg p-6 admission-step">
                    <div class="flex items-center mb-4">
                        <div class="bg-primary-green text-white rounded-full w-10 h-10 flex items-center justify-center text-xl font-bold mr-3">1</div>
                        <h3 class="text-xl font-semibold">{% trans "Formulaire d'Admission" %}</h3>
                    </div>
                    <p class="text-gray-600 mb-4">{% trans "Remplissez et soumettez le formulaire d'admission avec les documents requis." %}</p>
                    <p class="text-primary font-semibold mb-4">contact@green-up-academy.com</p>
                    <p class="text-gray-600">{% trans "Chaque candidature est examinée individuellement en fonction des attentes du programme choisi." %}</p>
                </div>
                <!-- Step 2 -->
                <div class="bg-white rounded-lg shadow-lg p-6 admission-step">
                    <div class="flex items-center mb-4">
                        <div class="bg-primary-green text-white rounded-full w-10 h-10 flex items-center justify-center text-xl font-bold mr-3">2</div>
                        <h3 class="text-xl font-semibold">{% trans "Étude de la Candidature" %}</h3>
                    </div>
                    <ul class="list-disc list-inside text-gray-600 mb-4 space-y-2">
                        <li>{% trans "Examen du dossier" %}</li>
                        <li>{% trans "Organisation d'un entretien" %}</li>
                        <li>{% trans "Envoi de la réponse" %}</li>
                    </ul>
                    <div class="bg-gray-100 p-4 rounded-lg">
                        <p class="font-semibold mb-2">{% trans "Frais d'admission :" %}</p>
                        <p>1 200 € {% trans "Frais d'inscription" %}</p>
                        <p>1 000 € {% trans "Arrhes (déductibles des frais de scolarité)" %}</p>
                    </div>
                </div>
                <!-- Step 3 -->
                <div class="bg-white rounded-lg shadow-lg p-6 admission-step">
                    <div class="flex items-center mb-4">
                        <div class="bg-primary-green text-white rounded-full w-10 h-10 flex items-center justify-center text-xl font-bold mr-3">3</div>
                        <h3 class="text-xl font-semibold">{% trans "Confirmation d'Inscription" %}</h3>
                    </div>
                    <p class="text-gray-600 mb-4">{% trans "Les documents suivants sont remis à l'issue de cette étape :" %}</p>
                    <ul class="list-disc list-inside text-gray-600 space-y-2">
                        <li>{% trans "Attestation d'inscription" %}</li>
                        <li>{% trans "Facture correspondant aux frais de dossier, aux frais de scolarité et aux frais techniques" %}</li>
                    </ul>
                </div>
            </div>
        </section>

        <!-- Cancellation Policy -->
        <section class="mb-16 bg-white rounded-lg shadow-lg p-8">
            <h2 class="text-2xl font-bold mb-6 text-center">{% trans "Conditions d'Annulation" %}</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div class="text-center p-4 border border-gray-200 rounded-lg">
                    <div class="bg-primary-green text-white rounded-full w-16 h-16 flex items-center justify-center text-2xl font-bold mx-auto mb-4">
                        >4
                    </div>
                    <h3 class="font-semibold mb-2">{% trans "Plus de 4 semaines avant la rentrée" %}</h3>
                    <p class="text-gray-600">{% trans "100% des arrhes remboursées (avec justificatifs)" %}</p>
                </div>
                <div class="text-center p-4 border border-gray-200 rounded-lg">
                    <div class="bg-primary-green text-white rounded-full w-16 h-16 flex items-center justify-center text-2xl font-bold mx-auto mb-4">
                        <4
                    </div>
                    <h3 class="font-semibold mb-2">{% trans "Moins de 4 semaines avant la rentrée" %}</h3>
                    <p class="text-gray-600">{% trans "Aucun remboursement des arrhes ni des frais d'inscriptions" %}</p>
                </div>
                <div class="text-center p-4 border border-gray-200 rounded-lg">
                    <div class="bg-primary-green text-white rounded-full w-16 h-16 flex items-center justify-center text-2xl font-bold mx-auto mb-4">
                        ✓
                    </div>
                    <h3 class="font-semibold mb-2">{% trans "Après la rentrée" %}</h3>
                    <p class="text-gray-600">{% trans "Pas de remboursement, sauf motif grave (avec justificatifs)" %}</p>
                </div>
            </div>
        </section>

        <!-- Session Information -->
        <section class="mb-16 bg-white rounded-lg shadow-lg p-8">
            <h2 class="text-2xl font-bold mb-6 text-center">{% trans "Sessions d'Admission" %}</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                {% for season in seasons %}
                    <div class="p-4 border border-gray-200 rounded-lg">
                        <h3 class="font-semibold text-lg mb-2">{{ season.name }}</h3>
                        <p><strong>{% trans "Date limite de candidature :" %}</strong> {{ season.end_date|date:"d F Y" }}</p>
                        <p><strong>{% trans "Date de la rentrée :" %}</strong> {{ season.session_start_date|date:"d F Y" }}</p>
                    </div>
                {% empty %}
                    <p class="text-gray-600 text-center col-span-2">{% trans "Aucune session d'admission ouverte actuellement." %}</p>
                {% endfor %}
            </div>
        </section>

        <!-- Application Form -->
        <section class="bg-white rounded-lg shadow-lg p-8 mb-16">
            <h2 class="text-3xl font-bold mb-8 text-center">{% trans "Formulaire d'Admission" %}</h2>
            <form method="POST" enctype="multipart/form-data" id="admission-form">
                {% csrf_token %}
                
                <!-- Personal Information -->
                <div class="form-section mb-8 p-6 border border-gray-200 rounded-lg">
                    <h3 class="text-xl font-semibold mb-6 text-primary">{% trans "Informations Personnelles" %}</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-gray-700 mb-2">{% trans "Civilité" %}</label>
                            <select name="civility" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-primary" required>
                                <option value="">{% trans "Sélectionner" %}</option>
                                {% for value, label in civility_choices %}
                                    <option value="{{ value }}">{{ label }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div>
                            <label class="block text-gray-700 mb-2">{% trans "Nom" %}</label>
                            <input type="text" name="last_name" value="{{ user_data.last_name|default:'' }}" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-primary" required>
                        </div>
                        <div>
                            <label class="block text-gray-700 mb-2">{% trans "Prénom" %}</label>
                            <input type="text" name="first_name" value="{{ user_data.first_name|default:'' }}" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-primary" required>
                        </div>
                        <div>
                            <label class="block text-gray-700 mb-2">{% trans "Date de Naissance" %}</label>
                            <input type="date" name="date_of_birth" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-primary" required>
                        </div>
                        <div>
                            <label class="block text-gray-700 mb-2">{% trans "Lieu de Naissance" %}</label>
                            <input type="text" name="place_of_birth" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-primary" required>
                        </div>
                        <div>
                            <label class="block text-gray-700 mb-2">{% trans "Nationalité" %}</label>
                            <input type="text" name="nationality" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-primary" required>
                        </div>
                        <div>
                            <label class="block text-gray-700 mb-2">{% trans "N° de Passeport" %}</label>
                            <input type="text" name="passport_number" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-primary" required>
                        </div>
                        <div>
                            <label class="block text-gray-700 mb-2">{% trans "Niveau d'Études" %}</label>
                            <input type="text" name="level_of_studies" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-primary" required>
                        </div>
                        <div>
                            <label class="block text-gray-700 mb-2">{% trans "E-mail" %}</label>
                            <input type="email" name="email" value="{{ user_data.email|default:'' }}" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-primary" required>
                        </div>
                        <div>
                            <label class="block text-gray-700 mb-2">{% trans "Téléphone" %}</label>
                            <input type="tel" name="phone_number" value="{{ user_data.phone_number|default:'' }}" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-primary" required>
                        </div>
                        <div class="md:col-span-2">
                            <label class="block text-gray-700 mb-2">{% trans "Adresse Permanente" %}</label>
                            <input type="text" name="address" value="{{ user_data.address|default:'' }}" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-primary" required>
                        </div>
                        <div>
                            <label class="block text-gray-700 mb-2">{% trans "Code Postal" %}</label>
                            <input type="text" name="zip_code" value="{{ user_data.zip_code|default:'' }}" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-primary" required>
                        </div>
                        <div>
                            <label class="block text-gray-700 mb-2">{% trans "Ville" %}</label>
                            <input type="text" name="city" value="{{ user_data.city|default:'' }}" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-primary" required>
                        </div>
                        <div>
                            <label class="block text-gray-700 mb-2">{% trans "Pays" %}</label>
                            <input type="text" name="country" value="{{ user_data.country|default:'' }}" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-primary" required>
                        </div>
                        <div>
                            <label class="block text-gray-700 mb-2">{% trans "Photo d'identité" %} <span class="text-red-500">*</span></label>
                            <input type="file" name="photo" accept=".jpg,.jpeg,.png" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-primary" required>
                        </div>
                    </div>
                </div>

                <!-- Parent/Guardian Information -->
                <div class="form-section mb-8 p-6 border border-gray-200 rounded-lg">
                    <h3 class="text-xl font-semibold mb-6 text-primary">{% trans "Responsable Principal" %}</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-gray-700 mb-2">{% trans "Nom" %}</label>
                            <input type="text" name="parent_last_name" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-primary">
                        </div>
                        <div>
                            <label class="block text-gray-700 mb-2">{% trans "Prénom" %}</label>
                            <input type="text" name="parent_first_name" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-primary">
                        </div>
                        <div>
                            <label class="block text-gray-700 mb-2">{% trans "Téléphone" %}</label>
                            <input type="tel" name="parent_phone_number" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-primary">
                        </div>
                        <div>
                            <label class="block text-gray-700 mb-2">{% trans "E-mail" %}</label>
                            <input type="email" name="parent_email" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-primary">
                        </div>
                        <div class="md:col-span-2">
                            <label class="block text-gray-700 mb-2">{% trans "Adresse" %}</label>
                            <input type="text" name="parent_address" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-primary">
                        </div>
                        <div>
                            <label class="block text-gray-700 mb-2">{% trans "Code Postal" %}</label>
                            <input type="text" name="parent_postal_code" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-primary">
                        </div>
                        <div>
                            <label class="block text-gray-700 mb-2">{% trans "Ville" %}</label>
                            <input type="text" name="parent_city" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-primary">
                        </div>
                        <div>
                            <label class="block text-gray-700 mb-2">{% trans "Pays" %}</label>
                            <input type="text" name="parent_country" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-primary">
                        </div>
                    </div>
                </div>

                <!-- Diploma Information -->
                <div class="form-section mb-8 p-6 border border-gray-200 rounded-lg">
                    <h3 class="text-xl font-semibold mb-6 text-primary">{% trans "Diplôme" %}</h3>
                    <div id="diploma-container">
                        <!-- Initial diploma entry -->
                        <div class="diploma-entry grid grid-cols-1 md:grid-cols-2 gap-6 mb-4" data-index="0">
                            <div class="md:col-span-2">
                                <label class="block text-gray-700 mb-2">{% trans "Diplôme obtenu (+ mention) ou en cours (précisez)" %}</label>
                                <textarea name="diploma_name_0" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-primary" rows="3" required></textarea>
                            </div>
                            <div>
                                <label class="block text-gray-700 mb-2">{% trans "École / Université" %}</label>
                                <input type="text" name="institution_0" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-primary" required>
                            </div>
                            <div>
                                <label class="block text-gray-700 mb-2">{% trans "Ville / Pays" %}</label>
                                <input type="text" name="city_country_0" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-primary" required>
                            </div>
                            <div>
                                <label class="block text-gray-700 mb-2">{% trans "Année" %}</label>
                                <input type="text" name="year_0" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-primary" required>
                            </div>
                            <div class="md:col-span-2">
                                <button type="button" class="remove-diploma bg-red-500 text-white px-4 py-2 rounded-lg" style="display: none;">{% trans "Supprimer le Diplôme" %}</button>
                            </div>
                        </div>
                    </div>
                    <button type="button" id="add-diploma" class="bg-primary-green text-white px-4 py-2 rounded-lg mt-4">{% trans "Ajouter un Autre Diplôme" %}</button>
                </div>

                <!-- Program, Campus, and Session Selection -->
                <div class="form-section mb-8 p-6 border border-gray-200 rounded-lg">
                    <h3 class="text-xl font-semibold mb-6 text-primary">{% trans "Choix de la Formation, des Campus et de la Session" %}</h3>
                    <!-- Session Selection -->
                    <div class="mb-6">
                        <label class="block text-gray-700 mb-4">{% trans "Choisissez la session d'admission" %}</label>
                        <select name="season" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-primary" required>
                            <option value="">{% trans "Sélectionner une session" %}</option>
                            {% for season in seasons %}
                                <option value="{{ season.id }}">{{ season.name }} ({{ season.session_start_date|date:"d F Y" }})</option>
                            {% endfor %}
                        </select>
                    </div>
                    <!-- Campus Selection -->
                    <div class="mb-6">
                        <label class="block text-gray-700 mb-4">{% trans "Choisissez le campus souhaité" %}</label>
                        <div class="flex flex-wrap gap-4">
                            {% for campus in campuses %}
                                <label class="flex items-center">
                                    <input type="radio" name="campus" value="{{ campus.id }}" class="form-radio text-primary" required>
                                    <span class="ml-2">{{ campus.name }}</span>
                                </label>
                            {% empty %}
                                <p class="text-gray-600">{% trans "Aucun campus disponible." %}</p>
                            {% endfor %}
                        </div>
                    </div>
                    <!-- Program Selection -->
                    <div>
                        <label class="block text-gray-700 mb-4">{% trans "Choisissez la formation souhaitée" %}</label>
                        <div class="overflow-x-auto">
                            <table class="program-table w-full rounded-lg overflow-hidden">
                                <thead>
                                    <tr class="bg-primary-green text-white">
                                        <th class="text-left p-4">{% trans "Formation" %}</th>
                                        <th class="p-4">{% trans "Campus" %}</th>
                                        <th class="p-4">{% trans "Frais de Scolarité" %}</th>
                                        <th class="p-4">{% trans "Sélection" %}</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for program in programs %}
                                        <tr>
                                            <td class="p-4">{{ program.name }}{% if program.is_work_study %}*{% endif %}</td>
                                            <td class="p-4 text-center">{{ program.campuses.all|join:", " }}</td>
                                            <td class="p-4 text-center">{{ program.tuition_fee }} €</td>
                                            <td class="p-4 text-center">
                                                <input type="radio" name="program" value="{{ program.id }}" class="form-radio text-primary" required>
                                            </td>
                                        </tr>
                                    {% empty %}
                                        <tr>
                                            <td colspan="4" class="p-4 text-center">{% trans "Aucune formation disponible." %}</td>
                                        </tr>
                                    {% endfor %}
                                </tbody>
                            </table>
                        </div>
                        <p class="text-sm text-gray-600 mt-4">* {% trans "Formation en alternance" %}</p>
                    </div>
                </div>

                <!-- Required Documents -->
                <div class="form-section mb-8 p-6 border border-gray-200 rounded-lg">
                    <h3 class="text-xl font-semibold mb-6 text-primary">{% trans "Documents à Joindre" %}</h3>
                    <p class="text-gray-600 mb-4">
                        {% trans "Veuillez téléverser les documents suivants (formats acceptés : PDF, JPEG, PNG) :" %}
                    </p>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-gray-700 font-medium mb-1">{% trans "Curriculum Vitae (CV)" %} <span class="text-red-500">*</span></label>
                            <input type="file" name="cv" accept=".pdf,.jpeg,.jpg,.png" class="w-full border border-gray-300 rounded-md p-2 focus:ring-2 focus:ring-primary-green focus:outline-none" required>
                        </div>
                        <div>
                            <label class="block text-gray-700 font-medium mb-1">{% trans "Lettre de motivation" %} <span class="text-red-500">*</span></label>
                            <input type="file" name="motivation_letter" accept=".pdf,.jpeg,.jpg,.png" class="w-full border border-gray-300 rounded-md p-2 focus:ring-2 focus:ring-primary-green focus:outline-none" required>
                        </div>
                        <div>
                            <label class="block text-gray-700 font-medium mb-1">{% trans "Portfolio (si applicable)" %}</label>
                            <input type="file" name="portfolio" accept=".pdf,.jpeg,.jpg,.png" class="w-full border border-gray-300 rounded-md p-2 focus:ring-2 focus:ring-primary-green focus:outline-none">
                        </div>
                        <div>
                            <label class="block text-gray-700 font-medium mb-1">{% trans "Copie du passeport" %} <span class="text-red-500">*</span></label>
                            <input type="file" name="identity_document" accept=".pdf,.jpeg,.jpg,.png" class="w-full border border-gray-300 rounded-md p-2 focus:ring-2 focus:ring-primary-green focus:outline-none" required>
                        </div>
                        <div>
                            <label class="block text-gray-700 font-medium mb-1">{% trans "Relevés de notes / Diplôme" %} <span class="text-red-500">*</span></label>
                            <input type="file" name="academic_records" accept=".pdf,.jpeg,.jpg,.png" class="w-full border border-gray-300 rounded-md p-2 focus:ring-2 focus:ring-primary-green focus:outline-none" required>
                        </div>
                        <div>
                            <label class="block text-gray-700 font-medium mb-1">{% trans "Attestation de langue (si non francophone)" %}</label>
                            <input type="file" name="language_certificate" accept=".pdf,.jpeg,.jpg,.png" class="w-full border border-gray-300 rounded-md p-2 focus:ring-2 focus:ring-primary-green focus:outline-none">
                        </div>
                        <div>
                            <label class="block text-gray-700 font-medium mb-1">{% trans "Photo d'identité récente" %} <span class="text-red-500">*</span></label>
                            <input type="file" name="photo" accept=".jpeg,.jpg,.png" class="w-full border border-gray-300 rounded-md p-2 focus:ring-2 focus:ring-primary-green focus:outline-none" required>
                        </div>
                    </div>
                </div>

                <!-- How did you hear about us -->
                <div class="form-section mb-8 p-6 border border-gray-200 rounded-lg">
                    <h3 class="text-xl font-semibold mb-6 text-primary">{% trans "Comment avez-vous connu la Green Up Academy ?" %}</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="flex items-center">
                                <input type="checkbox" name="internet" class="form-checkbox text-primary">
                                <span class="ml-2">{% trans "Internet" %}</span>
                            </label>
                        </div>
                        <div>
                            <label class="flex items-center">
                                <input type="checkbox" name="fair" class="form-checkbox text-primary">
                                <span class="ml-2">{% trans "Salon" %}</span>
                            </label>
                        </div>
                        <div>
                            <label class="flex items-center">
                                <input type="checkbox" name="word_of_mouth" class="form-checkbox text-primary">
                                <span class="ml-2">{% trans "Bouche à oreille" %}</span>
                            </label>
                        </div>
                        <div>
                            <label class="flex items-center">
                                <input type="checkbox" name="gua_student" class="form-checkbox text-primary">
                                <span class="ml-2">{% trans "Étudiant de la GUA" %}</span>
                            </label>
                        </div>
                        <div>
                            <label class="flex items-center">
                                <input type="checkbox" name="press" class="form-checkbox text-primary">
                                <span class="ml-2">{% trans "Presse" %}</span>
                            </label>
                        </div>
                        <div>
                            <label class="flex items-center">
                                <input type="checkbox" name="other" class="form-checkbox text-primary">
                                <span class="ml-2">{% trans "Autre" %}</span>
                            </label>
                        </div>
                    </div>
                </div>

                <!-- Declaration -->
                <div class="form-section mb-8 p-6 border border-gray-200 rounded-lg bg-gray-50">
                    <h3 class="text-xl font-semibold mb-6 text-primary">{% trans "Déclaration" %}</h3>
                    <p class="text-gray-600 mb-4">
                        {% trans "Je déclare sur l'honneur que les renseignements fournis dans ce formulaire sont exacts. Le comité d'admission se réserve le droit de vérifier toutes les pièces jointes à ma candidature. Je suis conscient que toute fausse déclaration peut entraîner le refus d'admission, l'annulation de l'admission ou l'expulsion." %}
                    </p>
                    <div class="mt-6">
                        <label class="flex items-start">
                            <input type="checkbox" name="declaration_accepted" class="form-checkbox text-primary mt-1" required>
                            <span class="ml-2">{% trans "J'accepte les termes de cette déclaration" %}</span>
                        </label>
                    </div>
                </div>

                <!-- Submit Button -->
                <div class="text-center">
                    <button type="submit" class="bg-primary-green hover:bg-green-600 text-white font-semibold py-3 px-8 rounded-lg transition-colors text-lg">
                        {% trans "Soumettre ma Candidature" %}
                    </button>
                </div>
            </form>
        </section>
    </div>
</main>

<script>
    // Initialize ToastManager
    document.addEventListener('DOMContentLoaded', function() {
        {% for message in messages %}
            {% if message.tags == 'success' %}
                window.notificationManager.showSuccess("{{ message }}", "top-right", 4000);
            {% elif message.tags == 'error' %}
                window.notificationManager.showError("{{ message }}", "top-right", 4000);
            {% endif %}
        {% endfor %}
    });

    // Diploma management
    document.getElementById('add-diploma').addEventListener('click', function() {
        const container = document.getElementById('diploma-container');
        const index = container.querySelectorAll('.diploma-entry').length;
        const newEntry = document.createElement('div');
        newEntry.className = 'diploma-entry grid grid-cols-1 md:grid-cols-2 gap-6 mb-4';
        newEntry.dataset.index = index;
        newEntry.innerHTML = `
            <div class="md:col-span-2">
                <label class="block text-gray-700 mb-2">{% trans "Diplôme obtenu (+ mention) ou en cours (précisez)" %}</label>
                <textarea name="diploma_name_${index}" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-primary" rows="3" required></textarea>
            </div>
            <div>
                <label class="block text-gray-700 mb-2">{% trans "École / Université" %}</label>
                <input type="text" name="institution_${index}" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-primary" required>
            </div>
            <div>
                <label class="block text-gray-700 mb-2">{% trans "Ville / Pays" %}</label>
                <input type="text" name="city_country_${index}" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-primary" required>
            </div>
            <div>
                <label class="block text-gray-700 mb-2">{% trans "Année" %}</label>
                <input type="text" name="year_${index}" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:border-primary" required>
            </div>
            <div class="md:col-span-2">
                <button type="button" class="remove-diploma bg-red-500 text-white px-4 py-2 rounded-lg">{% trans "Supprimer le Diplôme" %}</button>
            </div>
        `;
        container.appendChild(newEntry);
    });

    document.addEventListener('click', function(event) {
        if (event.target.classList.contains('remove-diploma')) {
            event.target.closest('.diploma-entry').remove();
        }
    });
</script>
{% endblock %}